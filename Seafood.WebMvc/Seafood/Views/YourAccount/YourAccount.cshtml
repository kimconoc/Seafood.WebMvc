@using Domain.Constant
@using Service.Helpers;
@{
    Layout = "~/Views/Shared/_LayoutAccountManager.cshtml";
    var masterDataHelper = new MasterDataHelper();
    var listRegion = masterDataHelper.GetListRegion();
}
@model Domain.Models.ResponseModel.User
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="~/assets/css/demo/account-manager/your-account.css" rel="stylesheet" />
    <style>
        /*ghi đè class*/
        .container-layout-account-manager {
            padding: 0 20px 0 20px;
        }
                .box-update-account .form-control-update-account .input-update:focus {
                    border: 1px solid rgb(7, 171, 226);
                }

        .container-update-account .col-1, .col-2, .col-3, .col-4, .col-5, .col-6, .col-7, .col-8, .col-9, .col-10, .col-11, .col-12, .col, .col-auto,
        .col-sm-1, .col-sm-2, .col-sm-3, .col-sm-4, .col-sm-5, .col-sm-6, .col-sm-7, .col-sm-8, .col-sm-9, .col-sm-10,
        .col-sm-11, .col-sm-12, .col-sm, .col-sm-auto, .col-md-1, .col-md-2, .col-md-3, .col-md-4, .col-md-5, .col-md-6,
        .col-md-7, .col-md-8, .col-md-9, .col-md-10, .col-md-11, .col-md-12, .col-md, .col-md-auto, .col-lg-1,
        .col-lg-2, .col-lg-3, .col-lg-4, .col-lg-5, .col-lg-6, .col-lg-7, .col-lg-8, .col-lg-9,
        .col-lg-10, .col-lg-11, .col-lg-12, .col-lg, .col-lg-auto, .col-xl-1, .col-xl-2, .col-xl-3, .col-xl-4, .col-xl-5,
        .col-xl-6, .col-xl-7, .col-xl-8, .col-xl-9, .col-xl-10, .col-xl-11, .col-xl-12, .col-xl, .col-xl-auto {
            padding-right: 0;
            padding-left: 0;
        }
    </style>
</head>

<body>
    <div class="container-update-account">
        <div class="heading">
            <h3>Tài khoản của bạn</h3>
        </div>
        <form enctype="multipart/form-data">
            <div class="col-md-3 col-sm-12">
                <div class="box-avatar-user">
                    <div class="avatar">
                        <img id="img_preview" src="https://salt.tikicdn.com/desktop/img/avatar.png" alt="avatar">
                    </div>
                    <label for="file_input">Chọn ảnh</label>
                    <input accept="image/*" name="imgUpload" type="file" id="file_input" />
                </div>
            </div>
            <div class="col-md-9 col-sm-12 menu">
                <div class="box-update-account">
                    <div class="form-control-update-account">
                        <label class="label-update">Họ và tên:</label>
                        <input id="display_name" required class="input-update" placeholder="Nhập họ và tên" maxlength="60" value="@Model.DisplayName">
                    </div>
                    <div class="form-control-update-account">
                        <label class="label-update">Email:</label>
                        @{
                            if (string.IsNullOrEmpty(Model.Email))
                            {
                                <input id="email" class="input-update" placeholder="Nhập email" maxlength="100" value="">
                            }
                            else
                            {
                                <input id="email" class="input-update" placeholder="Nhập email" maxlength="100" value="@Model.Email">
                            }
                        }
                    </div>
                    <div class="form-control-update-account">
                        <label class="label-update">Số điện thoại:</label>
                        <input id="mobile" disabled class="input-update" maxlength="10" value="@Model.Mobile.Trim()">
                    </div>
                    <div class="form-control-update-account">
                        <label class="label-update">Ngày sinh:</label>
                        <div class="box-check-birthday-option">
                            <select id="birthday" class="form-select" aria-label="Default select example">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                                <option value="9">9</option>
                                <option value="10">10</option>
                                <option value="11">11</option>
                                <option value="12">12</option>
                                <option value="13">13</option>
                                <option value="14">14</option>
                                <option value="15">15</option>
                                <option value="16">16</option>
                                <option value="17">17</option>
                                <option value="18">18</option>
                                <option value="19">19</option>
                                <option value="20">20</option>
                                <option value="21">21</option>
                                <option value="22">22</option>
                                <option value="23">23</option>
                                <option value="24">24</option>
                                <option value="25">25</option>
                                <option value="26">26</option>
                                <option value="27">27</option>
                                <option value="28">28</option>
                                <option value="29">29</option>
                                <option value="30">30</option>
                                <option value="31">31</option>
                            </select>
                            <select id="birthmonth" class="form-select" aria-label="Default select example">
                                <option value="1">Tháng 1</option>
                                <option value="2">Tháng 2</option>
                                <option value="3">Tháng 3</option>
                                <option value="4">Tháng 4</option>
                                <option value="5">Tháng 5</option>
                                <option value="6">Tháng 6</option>
                                <option value="7">Tháng 7</option>
                                <option value="8">Tháng 8</option>
                                <option value="9">Tháng 9</option>
                                <option value="10">Tháng 10</option>
                                <option value="11">Tháng 11</option>
                                <option value="12">Tháng 12</option>
                            </select>
                            <select id="birthyear" class="form-select" aria-label="Default select example">
                                 @for (int year = DateTime.Now.Year; year >= 1900; year--)
                                 {
                                   <option value="@year">@year</option>
                                 }
                             </select>
                        </div>
                    </div>
                    <div class="form-control-update-account">
                        <label class="label-update">Giới tính:</label>
                        <div class="box-check-radio-option">
                            <input type="radio" id="option_sex_nam" name="radio_option_sex" value="1" checked="checked" />
                            <label for="contactChoice1">Nam</label>
                            <input type="radio" id="option_sex_nu" name="radio_option_sex" value="0" />
                            <label for="contactChoice2">Nữ</label>
                            <input type="radio" id="option_sex_khac" name="radio_option_sex" value="-1" />
                            <label for="contactChoice2">Khác</label>
                        </div>
                    </div>
                    <div class="form-control-update-account">
                        <label class="label-update"></label>
                        <div class="box-click-continue">
                            <button onclick="updateInfoAccount()" class="btn-core-accept" type="submit">Cập nhật</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    <script>
        //Setup
        const fileInput = document.getElementById('file_input');
        const imgPreview = document.getElementById('img_preview');

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                const src = URL.createObjectURL(e.target.files[0]);
                imgPreview.src = src;
            }
        });
        $(document).ready(function () {
        });
        //Setup
        function updateInfoAccount()
        {
            debugger
            var displayName = document.getElementById("display_name").value;
            var email = document.getElementById("email").value;
            var sex = $("input[type='radio'][name='radio_option_sex']:checked").val();
            var year = document.getElementById("birthyear").value;
            var month = document.getElementById("birthmonth").value;
            var day = document.getElementById("birthday").value;

            if (isNullOrEmpty(displayName))
            {
                return;
            }
            var formData = new FormData($('form')[0]);
            $.ajax({
                cache: false,
                contentType: false,
                processData: false,
                data: formData,
                url: "@Url.Action("UploadAvartaUser", "Account")",
                type: 'Post',
                beforeSend: function ()
                {
                },
                success: function (data)
                {
                    if (data.Success) {
                        $.ajax({
                            type: "POST",
                            traditional: true,
                            data:
                            {
                                "displayName": displayName,
                                "email": email,
                                "sex": sex,
                                "year": year,
                                "month": month,
                                "day": day,
                            },
                            url: "@Url.Action("UploadProfileUser", "Account")",
                            success: function (data)
                            {
                            },
                        })
                    }
                    else {
                        alert(data.Message);
                    }
                },
                error: function ()
                {
                },
            });
        }
    </script>
</body>
</html>
